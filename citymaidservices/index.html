<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Maid Services - Find Reliable Domestic Help</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Add Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Add Maid Card Component -->
    <script type="module" src="js/components/maid-card-v2.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        poppins: ['Poppins', 'sans-serif'],
                    },
                    
                    colors: {
                        brand: {
                            primary: '#4F46E5',
                            secondary: '#4338CA',
                            light: '#EEF2FF',
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .profile-image {
                @apply aspect-[3/4] object-cover object-[center_15%];
            }
            
            .card-shadow {
                @apply shadow-md transition-all duration-300;
            }
            
            .card-shadow:hover {
                @apply shadow-lg -translate-y-0.5;
            }

            .section-title {
                @apply relative inline-block pb-4;
            }

            .section-title::after {
                content: '';
                @apply absolute bottom-0 left-1/2 -translate-x-1/2 w-20 h-[3px] bg-gradient-to-r from-brand-primary to-brand-secondary rounded-sm;
            }

            .badge {
                @apply bg-gradient-to-r from-brand-primary to-brand-secondary px-4 py-2 rounded-full text-white font-medium text-sm leading-5;
            }

            .truncate-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                @apply overflow-hidden;
            }
        }
    </style>
</head>
<body class="font-poppins">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20">
                <div class="flex items-center">
                    <a href="index.html" class="text-3xl font-bold text-brand-primary tracking-tight">City<span class="text-brand-secondary"> Maid Services</span></a>
                </div>
                <!-- Mobile menu button -->
                <div class="flex items-center md:hidden">
                    <button id="mobileMenuBtn" class="text-gray-700 hover:text-brand-primary focus:outline-none" aria-label="Open menu">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
                <!-- Desktop menu -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="text-brand-primary font-semibold">Home</a>
                    <a href="jobs/find-maids.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Maids</a>
                    <a href="jobs/find-jobs.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Jobs</a>
                    <a href="static/contact.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Contact Us</a>
                    <a href="static/about.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">About Us</a>
                    <a href="auth/login.html" class="bg-brand-primary text-white px-6 py-3 rounded-lg hover:bg-brand-secondary font-semibold transition-colors">Sign In</a>
                </div>
            </div>
        </div>
        <!-- Mobile menu panel -->
        <div id="mobileMenu" class="hidden md:hidden fixed inset-0 bg-black bg-opacity-50 z-50">
            <div class="fixed inset-y-0 right-0 max-w-xs w-full bg-white shadow-xl">
                <div class="flex items-center justify-between p-4 border-b">
                    <div class="flex items-center space-x-4">
                        <button onclick="window.history.back()" class="text-gray-500 hover:text-gray-700" aria-label="Go back">
                            <i class="fas fa-arrow-left text-xl"></i>
                        </button>
                        <a href="index.html" class="text-gray-500 hover:text-gray-700" aria-label="Go to homepage">
                            <i class="fas fa-home text-xl"></i>
                        </a>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-900">Menu</h2>
                    <button id="closeMobileMenu" class="text-gray-500 hover:text-gray-700" aria-label="Close menu">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                <div class="p-4 space-y-4">
                    <a href="index.html" class="block text-gray-700 hover:text-brand-primary font-medium transition-colors">Home</a>
                    <a href="jobs/find-maids.html" class="block text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Maids</a>
                    <a href="jobs/find-jobs.html" class="block text-gray-700 hover:text-brand-primary font-medium transition-colors">Find Jobs</a>
                    <a href="static/contact.html" class="block text-gray-700 hover:text-brand-primary font-medium transition-colors">Contact Us</a>
                    <a href="static/about.html" class="block text-gray-700 hover:text-brand-primary font-medium transition-colors">About Us</a>
                    <a href="auth/login.html" class="block bg-brand-primary text-white px-6 py-3 rounded-lg hover:bg-brand-secondary font-semibold transition-colors text-center">Sign In</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="bg-brand-light py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
                    Find Trusted Domestic Help in Your Area
                </h1>
                <p class="text-lg text-gray-600 mb-8">
                    Connect with verified domestic helpers for all your household needs. Post jobs or find work opportunities easily.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="auth/register.html" class="bg-brand-primary text-white px-8 py-4 rounded-lg hover:bg-brand-secondary transition-colors text-center font-semibold">
                        <i class="fas fa-user-plus mr-2"></i>Create Profile
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Latest Available Maids Section -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="section-title text-3xl font-bold text-gray-900">
                    Featured Domestic Helpers
                </h2>
                <p class="mt-6 text-lg text-gray-600">
                    Discover experienced and verified domestic helpers ready to assist you
                </p>
            </div>
            <div id="latestMaidsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Loading placeholder -->
                <div class="col-span-full flex justify-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary"></div>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="jobs/find-maids.html" class="inline-block bg-brand-primary text-white px-8 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                    Browse All Profiles <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Latest Jobs Section -->
    <section class="py-16 bg-brand-light">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="section-title text-3xl font-bold text-gray-900">
                    Recent Job Opportunities
                </h2>
                <p class="mt-6 text-lg text-gray-600">
                    Find your perfect domestic helper position with top employers
                </p>
            </div>
            <div id="latestJobsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Loading placeholder -->
                <div class="col-span-full flex justify-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-primary"></div>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="jobs/find-jobs.html" class="inline-block bg-brand-primary text-white px-8 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                    View All Jobs <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="section-title text-3xl font-bold text-gray-900">
                    Why Choose City Maid Services
                </h2>
                <p class="mt-6 text-lg text-gray-600">
                    We make finding domestic help simple, secure, and reliable
                </p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-brand-light rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user-check text-2xl text-brand-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Verified Profiles</h3>
                    <p class="text-gray-600">All domestic helpers are thoroughly verified for your safety</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-brand-light rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-bolt text-2xl text-brand-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Quick Matching</h3>
                    <p class="text-gray-600">Find the perfect match for your requirements quickly</p>
                </div>
                <div class="text-center p-6">
                    <div class="w-16 h-16 bg-brand-light rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-shield-alt text-2xl text-brand-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Secure Platform</h3>
                    <p class="text-gray-600">Your data and transactions are always protected</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">City Maid Services</h3>
                    <p class="text-gray-400">Connecting trusted domestic helpers with employers in your area.</p>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-400 hover:text-white transition-colors">Home</a></li>
                        <li><a href="jobs/find-jobs.html" class="text-gray-400 hover:text-white transition-colors">Find Jobs</a></li>
                        <li><a href="static/about.html" class="text-gray-400 hover:text-white transition-colors">About Us</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Contact</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center text-gray-400">
                            <i class="fas fa-map-marker-alt mr-2"></i> Kathmandu, Nepal
                        </li>
                        <li class="flex items-center text-gray-400">
                            <i class="fas fa-phone mr-2"></i> +977 1234567
                        </li>
                        <li class="flex items-center text-gray-400">
                            <i class="fas fa-envelope mr-2"></i> info@citymaidservices.com
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Follow Us</h3>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-facebook-f text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-instagram text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-linkedin-in text-xl"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; <span id="currentYear"></span> City Maid Services. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/supabase-config.js"></script>
    <script src="js/maid-profiles.js"></script>
    <script src="js/main.js"></script>
    <script type="module">
        import { createMaidCard } from './js/components/maid-card-v2.js';
        
        // Make the createMaidCard function available globally
        window.createMaidCard = createMaidCard;
        
        // Override the loadLatestMaids function to use the new maid card component
        window.loadLatestMaids = async function() {
            try {
                console.log('Loading latest maids...');
                const maids = await window.getLatestMaids(6);
                console.log('Received latest maids:', maids);
                
                const maidsContainer = document.getElementById('latestMaidsContainer');

                if (!maids || maids.length === 0) {
                    maidsContainer.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <p class="text-gray-500 text-lg">No maid profiles available at the moment.</p>
                        </div>
                    `;
                    return;
                }

                // Process profile images
                maids.forEach(maid => {
                    const imageField = maid.profile_image || maid.profile_photo;
                    if (!imageField) {
                        maid.profile_image = 'https://randomuser.me/api/portraits/women/1.jpg';
                    } else {
                        if (!imageField.startsWith('http')) {
                            maid.profile_image = `${window.supabase.supabaseUrl}/storage/v1/object/public/maid_profile_photos/${imageField}`;
                        } else if (imageField.includes('supabase.co') && !imageField.includes('/storage/v1/object/public/')) {
                            const filename = imageField.split('/').pop();
                            maid.profile_image = `${window.supabase.supabaseUrl}/storage/v1/object/public/maid_profile_photos/${filename}`;
                        } else {
                            maid.profile_image = imageField;
                        }
                    }
                });
                
                // Clear loading state
                maidsContainer.innerHTML = '';
                
                // Create shortened maid cards
                maids.forEach(maid => {
                    const card = createMaidCard(maid, {
                        short: true,
                        onContact: (maidId) => {
                            console.log('Contacting maid:', maidId);
                            window.location.href = `jobs/maid-details.html?id=${maidId}`;
                        },
                        onViewDetail: (maidId) => {
                            console.log('Viewing details for maid:', maidId);
                            window.location.href = `jobs/maid-details.html?id=${maidId}`;
                        }
                    });
                    maidsContainer.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading latest maids:', error);
                document.getElementById('latestMaidsContainer').innerHTML = `
                    <div class="col-span-full">
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                            <p class="font-bold">Error</p>
                            <p>${error.message}</p>
                        </div>
                    </div>
                `;
            }
        };
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded, initializing...');
            // Check if running from file system
            if (window.location.protocol === 'file:') {
                console.warn('Running from file system - network requests may be blocked');
            }
            window.loadLatestJobs();
            window.loadLatestMaids();
        });
    </script>
</body>
</html>